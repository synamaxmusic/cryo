;;
;; CRYO Image Decompressor for 6809
;; an experimental project by SynaMax, April 15th, 2024
;;
;;
;; Henrik, Bigs and others did the reverse engineering on this image format
;; Check out this awesome documentation here:
;; https://zwomp.com/posts/2021/exploring-the-dune-files-the-image-parts/
;;
;; This guide was extremely helpful in understanding how Dune and
;; MegaRace's image file formats work.  This program wouldn't have been possible
;; without their findings.
;;
;; MegaRace appears to have added support for 8-bit images, as the car sprites
;; use more than 16 colors in their palettes.  The compression method hasn't
;; changed though.
;;
;; Because Henrik hasn't released their Dune image tool to the public, I decided to
;; try and make my own program to decompress the sprites from MegaRace.
;;
;; I admit it's weird, but thanks to my recent Sinistar reverse engineeing efforts,
;; I currently feel more comfortable writing with 6809 assembly than attempting 
;; to wrtie in C.  Regardless, this program works as intended and successfully
;; decompresses the sprites from MegaRace, something I've been trying to achieve
;; since the mid-2000's.
;;							-- SynaMax 04/12/2024
;; 

;;
;; Any 6809 emulator should be able to run this code.  I got this code working by
;; replacing Sinistar's ROM 11 and ROM 10 and then running MAME with debugger.
;; I copied the RAM output at $9000 and then saved that sprite data to a new file.
;; Finally, I open up the new file in TiledGGD to view the graphic data.
;;
;; loadr ou_a.___,eefa,1000,:maincpu
;; This can be useful in MAME to load different sprites without rebuilding the code.
;;



;; Macroassembler {AS} CPU instruction

	CPU	6809

;; RADIX 16 make it easier for us to insert raw hex data into this source file
;; No need for $ in front of every number

	RADIX	16

;; RAM starts at 9000
RAM	SET	9000


;; Insert CPU vector for program start
	ORG	FFFE
	FDB	FF00
	
;; Compressed Cryo Sprite data goes here 
;; (NO HEADER, just paste the pixels only)
	ORG	E000

EXPLODE	
	fcb	E2,00,01,8B,8C,F8,8B,04,98,9E,8D,8B,8B,F9,8C,00
	fcb	88,E8,00,E9,00,02,86,94,B2,FE,B4,01,B2,9C,FC,89
	fcb	09,A2,A2,A0,A8,BD,BF,BE,B8,9F,A0,FD,89,07,95,A5
	fcb	AE,AF,B4,A0,9C,87,EB,00,EA,00,0A,9C,A8,AA,AA,AF
	fcb	B5,AF,AA,AA,AE,91,FC,87,0B,92,AE,A5,AF,B6,B8,87
	fcb	87,89,87,91,A2,FB,AA,04,B6,B8,B9,A9,92,EE,00,EC
	fcb	00,0E,84,A7,AA,A8,A7,AF,AA,B2,AA,B8,B5,AE,AA,A0
	fcb	84,FE,83,05,98,A2,A2,B1,AF,A8,FE,83,10,92,A5,A8
	fcb	AF,AA,B6,BC,BB,B6,AF,AA,AF,B4,B0,A4,98,82,F1,00
	fcb	EC,00,02,A4,AA,A5,FA,AA,13,B1,B2,AE,A2,91,85,85
	fcb	84,A5,A5,AA,B1,AF,A8,86,83,8B,A0,AE,B1,FC,AA,0D
	fcb	AF,B5,AE,AA,AF,A7,A4,A0,8C,82,00,81,9D,8B,F6,00
	fcb	F0,00,03,82,83,83,92,FE,A8,2E,AA,A0,9E,9A,A1,A7
	fcb	B8,AF,AA,A0,A1,A0,89,85,92,AA,AA,B1,B1,AF,A8,8F
	fcb	85,92,A8,AF,AE,A1,A9,A4,AE,AF,AA,AF,A8,A8,AF,AE
	fcb	9E,9E,94,85,81,85,85,86,82,F7,00,F0,00,16,86,88
	fcb	88,97,98,A8,AA,9E,94,96,96,94,8D,90,A9,A2,A0,A1
	fcb	9C,95,83,98,AA,FE,B1,17,AF,A7,92,87,98,A2,9A,94
	fcb	96,96,94,90,9E,A7,AA,A5,A8,A8,B2,9F,9B,96,87,86
	fcb	F9,8C,00,82,FC,00,F1,00,0C,81,86,86,8C,9B,97,AE
	fcb	A1,96,94,8E,8E,87,FE,8D,07,9A,9F,9F,9B,94,87,A2
	fcb	AF,FE,B1,08,AF,A7,95,94,97,94,8E,8E,94,FE,8E,0C
	fcb	8D,9B,A0,B2,AE,9F,B2,AE,9B,96,8D,84,9D,FA,86,00
	fcb	83,FC,00,F1,00,0A,83,88,86,8D,9B,97,A1,97,97,96
	fcb	8D,FE,82,09,8E,8D,8E,9B,A0,94,8E,8C,AA,AF,FE,B1
	fcb	04,AA,A5,98,8E,96,FB,8E,0E,82,85,94,97,B5,A4,A4
	fcb	AE,A4,9B,96,8D,82,B5,8B,FB,86,00,83,FC,00,F2,00
	fcb	38,81,87,8C,8C,90,9E,A1,9E,97,9B,97,8D,84,84,82
	fcb	8E,8E,90,9A,A1,94,94,8D,AA,B1,B1,B7,B1,AF,A7,98
	fcb	94,96,94,8E,94,8E,8E,87,84,82,8D,9B,B0,A4,9E,9E
	fcb	A1,97,96,8D,86,A0,97,8D,8C,86,FE,88,00,86,FC,00
	fcb	F4,00,07,81,87,8B,8D,8D,89,90,9B,FE,9E,02,9B,9B
	fcb	94,FE,85,2D,8E,8E,96,9E,A9,94,9B,95,AA,AF,B1,B7
	fcb	B1,AF,A7,9E,A4,9E,9B,9B,96,94,96,8D,85,85,90,97
	fcb	A9,A1,9E,9E,A1,97,96,8C,8D,8D,90,8D,8D,89,86,88
	fcb	88,86,FC,00,F5,00,1B,82,89,8B,8D,8B,89,89,8D,97
	fcb	97,A1,9E,A8,A0,98,97,92,95,8D,94,96,A1,A9,94,97
	fcb	9D,AA,AF,FE,B7,0F,AF,A7,9E,A1,A1,9E,A0,9F,9C,A0
	fcb	97,8C,8D,97,94,A9,FE,9E,05,A1,94,8D,89,8B,8B,FD
	fcb	90,03,8C,88,86,86,FC,00,F5,00,01,82,89,FD,8B,15
	fcb	89,87,97,94,9E,A1,A0,A8,A3,A5,A5,A2,94,9B,97,A4
	fcb	A1,94,94,9C,AA,B6,FE,B7,20,AF,A8,9E,97,9E,A0,A4
	fcb	A8,A0,98,A2,A0,94,9B,9E,A4,9E,94,9E,9E,94,87,89
	fcb	89,8B,8D,90,90,8D,8D,87,86,83,FC,00,FE,00,00,86
	fcb	F4,88,16,86,86,87,8D,94,97,A1,98,A0,A0,A8,A8,A5
	fcb	94,94,A4,9E,94,96,94,9C,AF,B7,FE,BC,06,AF,A8,9E
	fcb	8D,9E,9B,A2,FD,A8,0D,98,98,94,A4,A1,94,9B,9E,96
	fcb	8D,87,86,87,89,FC,8C,FE,88,FE,83,01,81,00,04,00
	fcb	00,82,83,83,FD,86,04,88,89,8B,83,83,FE,86,16,83
	fcb	83,86,86,94,96,97,A1,9B,94,A0,94,9A,9B,A1,9E,9B
	fcb	8D,8D,87,98,97,AA,FE,B7,15,A0,95,8F,8D,90,9E,9A
	fcb	98,98,96,98,94,9B,A4,A1,97,96,9B,9B,8D,86,83,FD
	fcb	86,01,8C,89,F9,88,01,86,00,FF,00,FC,86,09,83,86
	fcb	8B,89,8B,88,83,83,86,86,FE,83,08,86,85,87,85,8D
	fcb	97,9E,9E,97,FE,85,06,8D,86,87,8E,8E,8D,8D,FE,90
	fcb	15,94,90,8D,8D,8E,8D,87,8C,8C,8D,9E,9E,A1,A1,9E
	fcb	94,87,8D,97,8D,84,86,FD,83,04,86,8D,89,89,85,FE
	fcb	83,FD,86,00,82,03,00,81,88,88,FE,86,01,83,89,FE
	fcb	8B,00,89,FD,86,02,83,83,82,FE,85,06,87,87,85,83
	fcb	87,83,87,FE,89,03,86,87,8D,8E,F9,8D,13,8E,8D,87
	fcb	89,89,87,85,87,8D,8D,87,85,87,86,85,85,82,85,86
	fcb	83,FE,86,05,89,8B,8B,89,86,83,FB,86,00,82,01,00
	fcb	83,FD,88,02,86,88,89,FD,8B,00,89,FE,86,14,83,83
	fcb	82,85,87,8C,8B,8B,89,89,87,87,89,8B,89,89,85,86
	fcb	87,8D,8C,FD,8B,FF,8C,FE,8D,FD,89,04,85,84,85,86
	fcb	87,FE,89,08,86,84,82,85,85,83,86,86,89,FE,8B,01
	fcb	89,88,FE,86,FD,88,00,83,01,00,86,FD,88,08,86,87
	fcb	89,91,8D,8B,8B,89,87,FE,86,04,83,82,83,8B,8B,FD
	fcb	89,01,87,85,FE,8B,FE,89,F7,8B,FE,89,FE,8B,05,84
	fcb	85,86,87,89,89,FE,8B,07,85,84,85,86,83,86,88,89
	fcb	FD,8B,08,89,86,86,88,88,8A,8A,88,83,01,81,86,FE
	fcb	88,09,86,86,87,89,93,90,91,8B,89,88,FC,83,01,82
	fcb	88,FE,89,07,87,89,87,87,8B,91,90,89,F4,8B,08,89
	fcb	89,8B,8B,87,88,85,85,87,FD,89,0F,8B,87,82,86,86
	fcb	83,86,89,89,8B,8B,91,8B,89,86,86,FC,88,00,83,01
	fcb	81,86,FE,88,09,86,86,87,89,95,93,91,8B,89,89,FE
	fcb	83,06,82,83,85,87,8B,89,89,FC,8B,04,9D,93,89,8B
	fcb	91,FE,93,0C,9D,A8,A2,9D,9D,98,8B,8B,89,8B,91,8B
	fcb	89,FE,8B,FE,89,FE,87,0C,82,84,84,82,83,87,89,8B
	fcb	91,91,95,8B,8C,FE,86,FD,88,00,83,03,81,86,88,88
	fcb	FE,86,0A,87,8A,97,93,93,91,8B,8B,87,89,8C,FD,8B
	fcb	0A,89,89,8B,8B,91,93,93,8B,A8,A2,88,FD,9D,01,A0
	fcb	A2,FA,A8,02,98,91,91,F7,8B,07,89,89,87,85,83,82
	fcb	89,8B,FE,98,02,A0,8B,89,FE,86,FD,88,00,83,03,81
	fcb	86,88,88,FD,86,00,8C,FE,98,02,93,91,90,FD,8B,05
	fcb	91,90,91,93,97,97,FE,98,06,9F,8B,A8,A8,88,9F,9F
	fcb	FE,9D,0C,A0,A3,A8,A8,AC,A8,A8,AC,87,93,93,8B,95
	fcb	FE,A8,FE,98,00,93,FB,8B,0B,89,8B,93,9D,A3,A3,AC
	fcb	8B,88,83,86,86,FD,88,00,83,00,81,FD,88,FE,86,06
	fcb	89,97,98,97,98,93,91,FC,93,FD,97,FE,98,06,9F,9D
	fcb	8B,A3,A3,88,9F,FC,9D,02,A2,A8,AC,FE,A8,0F,AC,86
	fcb	91,91,8B,95,AE,AE,AC,A8,A8,AC,AC,A8,A8,A2,FE,97
	fcb	0B,8B,8B,98,A3,A8,B2,9F,8B,87,83,86,86,FD,88,00
	fcb	83,00,81,FD,88,0A,86,86,83,88,91,97,97,98,93,93
	fcb	91,FD,93,FF,98,FC,97,05,98,98,8B,97,98,88,FB,9D
	fcb	03,A2,A8,A8,AC,FE,A8,04,86,90,91,8B,A0,FB,AC,01
	fcb	A8,AC,FC,A8,07,97,8B,A8,AC,AE,B2,9D,8C,FD,86,FD
	fcb	88,00,83,00,81,FC,88,03,86,86,87,8B,FC,93,00,91
	fcb	FD,93,01,95,93,FC,98,06,97,97,89,90,92,87,98,FE
	fcb	9D,05,98,93,93,9F,A8,A8,FE,AC,00,86,FE,8B,FF,A8
	fcb	F8,AC,FE,A8,01,97,90,FD,A8,04,89,89,83,86,86,FC
	fcb	88,00,83,00,81,FC,88,FE,86,00,87,FD,91,00,90,FC
	fcb	8B,02,8D,8D,8C,FA,89,02,8B,8B,87,FD,89,00,88,FE
	fcb	87,FC,89,00,85,FE,8B,02,97,98,97,FC,98,FB,A8,06
	fcb	89,93,9D,A0,A0,97,89,FE,86,FB,88,00,83,01,81,86
	fcb	FE,88,FE,86,01,85,87,FC,8B,00,89,FD,85,05,83,83
	fcb	85,86,86,85,FE,86,03,87,89,89,85,FC,86,02,87,88
	fcb	88,FC,89,00,85,FE,89,00,86,F5,89,0A,87,89,8B,91
	fcb	93,93,8B,89,83,86,86,FB,88,00,83,01,81,83,FC,86
	fcb	04,83,83,85,89,8B,FD,89,FD,82,02,81,41,41,FE,82
	fcb	FD,84,02,85,86,82,FB,84,FF,82,FE,84,07,83,84,84
	fcb	87,87,85,84,83,F9,82,04,41,41,82,85,89,FD,8B,05
	fcb	89,89,83,83,86,86,FC,88,00,83,04,81,83,83,86,86
	fcb	FC,83,00,87,FC,89,00,85,FE,82,FD,41,FC,82,F7,84
	fcb	FF,82,FD,84,04,83,83,82,82,83,F8,82,FD,41,00,82
	fcb	FD,89,04,8B,87,85,83,83,FB,86,01,83,82,01,00,82
	fcb	FA,83,01,82,83,FD,89,01,88,85,FE,82,04,41,41,42
	fcb	41,41,FA,81,02,82,84,84,FE,82,FF,84,F2,82,00,84
	fcb	FE,82,05,41,42,41,41,82,87,FD,89,01,87,82,FD,83
	fcb	FD,86,01,83,82,01,00,82,FA,83,07,82,82,85,89,88
	fcb	88,87,83,FE,82,03,41,41,42,42,F4,41,0A,42,41,42
	fcb	41,42,41,42,41,42,41,42,F6,41,05,42,42,41,41,82
	fcb	88,FE,89,03,87,83,82,82,F9,83,00,82,01,00,81,FA
	fcb	83,FE,82,FD,86,2F,83,82,82,81,41,42,43,44,43,44
	fcb	43,44,43,42,43,42,43,42,43,42,43,42,43,42,43,42
	fcb	43,42,43,42,43,42,43,42,43,42,43,42,43,44,43,44
	fcb	43,44,43,42,41,82,FD,87,02,83,82,82,F8,83,00,82
	fcb	03,00,00,82,82,FD,83,FC,82,02,83,85,85,FE,82,32
	fcb	81,44,44,46,44,00,44,00,44,00,44,00,44,00,44,00
	fcb	44,00,44,00,44,00,44,00,44,00,44,00,44,00,44,00
	fcb	44,00,44,00,44,00,44,00,44,46,44,44,81,85,85,86
	fcb	84,82,82,F7,83,00,81,FE,00,FB,81,F8,82,30,42,44
	fcb	45,00,45,00,45,00,45,00,45,00,45,00,45,00,45,00
	fcb	45,00,45,00,45,00,45,00,45,00,45,00,45,00,45,00
	fcb	45,00,45,00,45,00,45,00,45,00,45,44,82,84,83,FC
	fcb	82,FA,83,01,82,81,F7,00,FA,81,31,42,45,46,00,46
	fcb	00,46,00,46,00,46,00,46,00,46,00,46,00,46,00,46
	fcb	00,46,00,46,00,46,00,46,00,46,00,46,00,46,00,46
	fcb	00,46,00,46,00,46,00,46,00,45,81,82,82,F4,81,00
	fcb	00,52,80,25,FF,E0,00,06,85,8B,95,9C,98,98,95,FD
	fcb	8B,03,9E,98,8D,8B,F9,8C,02,8A,8A,86,EA,00,E8,00
	fcb	08,86,A0,B2,AE,AA,B4,B4,A1,94,FC,89,08,97,A0,9F
	fcb	B8,BF,BF,BD,AE,9F,FD,89,07,97,A5,AE,AF,B9,BB,AE
	fcb	88,EB,00,E9,00,12,9C,AA,AA,AE,B5,BA,AF,AA,AA,B2
	fcb	A9,87,87,89,89,87,87,A0,A5,FE,AF,00,A4,FE,87,01
	fcb	98,A2,FC,AA,05,B1,BC,BD,B9,A4,9E,EE,00,EB,00,0D
	fcb	86,AA,A5,A8,AE,AE,AF,B8,B6,BD,BA,AA,AA,9F,FD,84
	fcb	1A,92,A2,A2,B1,AF,A8,9C,83,89,9C,A5,AE,B5,BB,BF
	fcb	BD,B6,AF,AA,AF,B5,B5,B3,B3,A4,97,83,F2,00,EB,00
	fcb	1C,A8,AA,A5,AA,AA,AE,B2,AF,B1,B7,B8,B4,A5,A0,98
	fcb	84,85,83,A2,A5,AA,B1,AF,A8,98,86,9D,AF,B1,FD,AA
	fcb	0C,B6,B6,B5,AF,B1,AF,A8,A8,A4,A4,9C,85,85,FC,00
	fcb	02,83,89,81,FB,00,EC,00,2F,92,A5,A8,A5,9B,9A,96
	fcb	A1,B9,BA,AA,A5,A8,A4,9C,A0,8D,85,8A,AA,AA,B1,B1
	fcb	AF,A8,8F,8D,AA,A8,9F,A9,A7,BD,B6,AA,AA,AE,AE,A8
	fcb	AF,AE,A4,A0,9E,A0,8C,85,82,FD,00,FE,85,00,81,FC
	fcb	00,ED,00,04,82,94,AE,A0,96,FD,94,0B,90,A7,A7,A0
	fcb	A0,9F,9B,9D,95,83,92,AA,FE,B1,04,AF,A7,94,A0,9B
	fcb	FC,94,12,A7,AE,AA,AF,A8,A8,AE,AF,AE,9F,9B,A1,9E
	fcb	85,85,00,00,81,86,FD,88,FE,83,01,82,00,ED,00,14
	fcb	87,9B,A1,96,9A,9A,94,94,8D,86,8D,9A,9B,A0,9E,97
	fcb	94,9E,85,AA,AF,FE,B1,05,AF,A5,8E,94,8E,8E,FE,94
	fcb	12,8E,8E,98,A0,AF,A8,A8,A4,B5,B5,9E,9B,96,99,87
	fcb	85,B2,AE,98,FE,86,FC,88,01,83,00,EE,00,08,81,8D
	fcb	9B,9E,97,9B,94,96,8D,FE,82,03,8E,8E,A0,9F,FE,94
	fcb	07,87,AA,AA,B1,B7,B1,AA,A0,FD,8E,00,94,FC,8E,12
	fcb	9B,AE,B8,A4,9E,B5,B2,9E,9E,94,96,8D,84,B8,B8,A2
	fcb	8B,86,83,FC,86,01,83,81,F0,00,0A,82,87,87,9B,A1
	fcb	A1,9B,9E,97,94,8D,FE,84,2D,8E,96,A4,A4,96,96,94
	fcb	98,AA,B1,B1,B7,AF,A8,9C,94,8E,94,8E,96,94,8E,8E
	fcb	87,82,9B,A4,B4,A0,9E,A1,A9,9E,9B,94,94,8C,87,A0
	fcb	B8,B8,92,8D,88,86,86,FE,88,01,83,81,F2,00,00,83
	fcb	FD,89,07,8D,9E,A7,9E,A1,9B,98,98,FE,86,12,96,97
	fcb	A9,A4,97,9A,9B,92,AA,B6,B1,B7,AF,A7,9F,A1,9B,9E
	fcb	9B,FE,94,0C,9A,86,84,97,A1,A9,A1,9E,9E,A4,A1,9B
	fcb	96,FE,8D,02,90,90,8D,FE,91,FF,86,FE,88,01,83,81
	fcb	F3,00,36,81,89,8B,89,89,87,8D,9B,A4,A0,AE,AE,9F
	fcb	A5,A0,92,90,97,9B,A9,A1,9B,9B,97,A2,AF,B6,B7,B7
	fcb	AF,A8,9F,A4,9B,A8,A8,9E,98,9C,A0,8A,89,94,A1,A9
	fcb	9E,9A,A1,A4,9A,97,94,89,8D,91,FE,93,09,90,8D,91
	fcb	89,86,86,88,88,83,81,FD,00,00,81,F8,83,19,86,8C
	fcb	89,88,87,87,8D,96,9E,A8,A0,AE,A8,9F,A5,9D,97,96
	fcb	A1,A9,9E,96,9A,94,AA,AF,FE,B7,19,AF,AF,A5,9E,A0
	fcb	A8,A8,AE,9F,9C,A2,A0,9B,96,A9,A4,9E,9A,A1,A1,94
	fcb	96,8D,89,8C,8B,FD,90,02,8D,8C,85,FE,86,02,88,83
	fcb	81,FE,00,00,81,FB,88,02,89,8C,86,FD,88,16,86,86
	fcb	83,86,8D,94,9E,9F,A7,A0,9F,A2,94,94,9E,A1,9B,96
	fcb	94,96,8E,AA,AF,FE,B7,1A,B6,A8,A5,94,9B,A0,A4,AE
	fcb	A8,A8,9C,98,94,A1,A9,9E,9A,9B,A1,9B,96,90,86,86
	fcb	89,8B,8B,FE,90,08,8D,8C,85,86,86,88,88,83,82,FE
	fcb	00,FF,86,FD,83,02,89,89,8B,FB,83,08,86,83,84,85
	fcb	90,94,9E,9A,94,FE,97,FE,9E,00,96,FE,8D,1D,87,97
	fcb	9D,A0,A0,B7,A5,98,95,87,96,9B,98,94,9B,98,94,94
	fcb	A1,A9,9B,9E,94,9E,9E,96,94,85,83,83,FE,86,F7,88
	fcb	FF,82,02,00,00,83,FD,86,01,83,89,FE,8B,10,88,83
	fcb	83,86,86,83,83,82,82,85,84,85,8C,8D,9E,9E,87,FD
	fcb	85,03,86,86,8E,8E,FE,8D,01,92,90,FC,8D,00,87,FE
	fcb	8D,0D,97,9E,A1,A1,A4,9B,94,8D,8D,9B,96,8D,86,82
	fcb	FE,83,03,8B,89,89,83,FA,86,02,83,83,81,04,00,00
	fcb	86,88,88,FE,86,00,89,FD,8B,FC,86,FD,82,06,85,89
	fcb	89,87,85,85,87,FE,89,05,85,87,87,8D,8D,8E,F8,8D
	fcb	04,88,89,87,87,85,FE,8D,11,87,85,87,86,85,85,82
	fcb	82,83,83,86,83,89,8B,8B,89,86,83,FB,86,02,83,83
	fcb	81,01,00,81,FD,88,01,86,89,FC,8B,00,88,FD,86,FE
	fcb	82,00,87,FD,89,0B,87,85,89,8B,8B,89,85,86,87,87
	fcb	8B,89,FE,8B,04,8C,8C,87,8D,87,FD,89,10,85,84,85
	fcb	86,86,88,89,89,87,87,85,82,82,85,83,86,88,FD,8B
	fcb	00,87,FD,86,FE,88,02,86,83,81,01,00,83,FE,88,0F
	fcb	86,86,89,90,90,8B,8B,89,89,83,86,86,83,82,82,86
	fcb	FD,89,07,87,87,86,89,91,8B,89,88,F6,8B,0B,89,87
	fcb	89,8B,8B,87,85,85,86,87,89,89,FE,8B,07,89,84,82
	fcb	82,85,83,88,89,FD,8B,02,89,86,86,FC,88,02,86,82
	fcb	81,09,00,86,88,88,86,86,83,89,91,91,FD,8B,FD,83
	fcb	FE,82,0A,87,87,89,89,87,87,89,8B,93,91,89,F4,8B
	fcb	00,89,FE,8B,05,89,87,85,85,87,88,FE,89,FF,8B,FE
	fcb	82,0A,83,83,89,89,8B,8B,91,8B,89,86,86,FE,88,04
	fcb	8A,8A,86,86,81,0A,00,86,88,88,86,86,83,89,93,93
	fcb	90,FE,8B,09,85,83,83,86,86,87,89,8B,89,89,FC,8B
	fcb	02,9D,93,89,FE,8B,0E,91,93,97,9D,9F,97,98,97,8B
	fcb	8B,87,8B,91,90,87,FE,8B,FE,89,03,87,89,89,85,FE
	fcb	82,08,83,86,89,8B,91,93,93,8B,88,FE,86,FD,88,02
	fcb	83,8D,81,02,81,83,88,FE,86,07,83,89,93,93,91,8B
	fcb	91,91,FC,8B,FE,89,FE,8B,06,8D,91,8B,8B,A8,98,89
	fcb	FC,93,03,98,97,9D,A0,FD,A2,04,87,8B,91,91,89,F9
	fcb	8B,0D,89,87,85,84,82,82,89,8D,93,93,97,97,8B,88
	fcb	FE,86,FD,88,02,83,8D,81,0F,81,86,88,88,86,86,83
	fcb	89,8D,93,91,8B,91,90,89,89,FE,8B,03,8D,90,90,91
	fcb	FD,93,05,8D,8B,AE,9D,89,95,FC,93,07,97,9D,A0,A2
	fcb	A2,A3,A3,89,FE,91,02,A3,A3,A8,FE,97,FA,8B,0C,89
	fcb	89,8B,97,9D,A0,A0,97,8B,87,83,86,86,FD,88,02,83
	fcb	8D,82,00,81,FE,88,04,86,86,83,88,8B,FE,91,08,8B
	fcb	93,8B,8B,91,90,90,91,91,FB,93,04,8D,89,A8,97,89
	fcb	FB,93,0A,97,9D,A2,A2,A3,A3,93,89,8B,8B,89,F8,A8
	fcb	FE,97,FD,8B,06,A0,A2,A3,AC,95,91,83,FE,86,FD,88
	fcb	02,83,8D,82,00,81,FD,88,FE,86,00,89,FE,91,06,8B
	fcb	93,8B,8B,91,90,90,F9,91,04,8B,89,98,92,88,FB,93
	fcb	0A,98,9D,A2,A2,A3,A3,93,89,8B,8B,89,F3,A8,0A,91
	fcb	97,A2,A8,A8,AC,8B,8C,83,86,86,FC,88,02,83,8D,82
	fcb	00,81,FD,88,FE,86,00,87,FD,8B,00,91,FC,8B,FF,91
	fcb	FE,90,FE,91,04,8B,89,90,89,89,FB,8B,0B,91,91,A0
	fcb	A0,A3,A3,9D,89,8B,8B,87,A3,FB,A8,FE,AC,FD,A8,0A
	fcb	89,93,A3,A8,A8,9F,89,87,83,86,86,FC,88,02,83,87
	fcb	81,00,81,FD,88,03,86,86,83,87,FE,8B,03,89,8B,89
	fcb	87,F6,89,06,88,89,8B,89,87,88,89,FE,88,FF,87,FC
	fcb	89,0A,87,88,8B,8B,90,97,97,98,97,97,9F,F9,A8,00
	fcb	8B,FE,9D,05,A0,93,89,83,86,86,FB,88,02,83,83,81
	fcb	00,81,FC,86,08,83,83,85,89,8B,89,89,8B,8B,FB,85
	fcb	0F,83,83,86,86,85,86,85,86,89,88,85,86,86,87,86
	fcb	86,FD,85,FE,89,04,87,87,89,89,87,F5,89,02,91,91
	fcb	8B,FD,93,FF,89,FE,86,FB,88,02,83,83,81,01,00,83
	fcb	FE,86,FD,83,00,87,FC,89,00,86,FD,82,03,81,81,41
	fcb	81,FE,82,04,84,84,85,84,82,FB,84,FE,82,00,83,FE
	fcb	84,09,85,87,87,85,84,84,83,82,82,83,FB,85,01,82
	fcb	87,FC,8B,04,89,86,83,86,86,FB,88,02,83,82,00,01
	fcb	00,82,FB,83,01,82,83,FC,89,00,85,FD,82,03,81,81
	fcb	41,41,FC,82,F8,84,FE,82,06,84,84,83,83,84,82,84
	fcb	F5,82,FF,41,FA,89,FE,83,FA,86,02,83,82,00,01,00
	fcb	82,FB,83,02,82,82,86,FD,89,00,85,FD,82,00,81,FD
	fcb	41,F3,81,00,84,EE,82,04,81,41,41,87,87,FE,89,01
	fcb	87,86,FD,83,FB,86,02,83,82,00,01,00,81,FB,83,FE
	fcb	82,FD,87,06,85,82,83,82,82,81,41,FE,42,25,41,42
	fcb	41,42,41,42,41,42,41,42,41,42,41,42,41,42,41,42
	fcb	41,42,41,42,41,42,41,42,41,42,41,42,41,42,81,81
	fcb	42,41,41,87,FD,89,02,87,83,82,F8,83,02,82,82,00
	fcb	02,00,00,82,FB,83,3C,82,82,83,85,85,86,85,83,83
	fcb	82,82,42,43,44,43,44,43,45,43,45,43,44,43,44,43
	fcb	45,43,44,43,44,43,45,43,44,43,45,43,44,43,45,43
	fcb	44,43,45,43,44,43,45,43,44,43,42,41,85,89,88,89
	fcb	87,83,82,82,F8,83,02,82,82,00,FE,00,F1,82,31,81
	fcb	44,45,46,45,00,45,00,45,00,45,00,45,00,45,00,45
	fcb	00,45,00,45,00,45,00,45,00,45,00,45,00,45,00,45
	fcb	00,45,00,45,00,45,46,45,44,42,82,87,86,87,84,82
	fcb	82,F7,83,02,82,82,00,FD,00,F2,81,30,45,46,00,46
	fcb	00,46,00,46,00,46,00,46,00,46,00,46,00,46,00,46
	fcb	00,46,00,46,00,46,00,46,00,46,00,46,00,46,00,46
	fcb	00,46,00,46,00,46,45,81,85,85,84,82,82,F6,83,02
	fcb	82,81,00,E4,00,23,46,00,46,00,46,00,46,00,46,00
	fcb	46,00,46,00,46,00,46,00,46,00,46,00,46,00,46,00
	fcb	46,00,46,00,46,00,46,45,42,81,F2,82,FF,00,C0,00
	fcb	F3,81,02,00,00,00

DATAEND	SET	*

;;	
;; RLE Decompression routine spits out raw image data in RAM
;;

	ORG	FF00

	LDY	#RAM		;Load RAM address into Y
	LDU     #EXPLODE	;Grab address for sprite data	
	LDX	#DATAEND
	
;;
;; The first routine checks the first byte of the pixel data.
;; If the number is signed, then we repeat the following byte.
;;
;; Otherwise, the unsigned number represents how many bytes we
;; need to copy as-is.
;;
BYTECHK	LDA	U		;Check first byte
	ANDA	#$80		;If signed, we repeat byte
	BEQ	SPRCOPY		;  otherwise, data is copied as is.

;;
;; To get our repeat counter, we load the signed number into A,
;; use NEGA to make it positive, then add 1.  This is our final
;; repeat value. Repeat the next byte with the final repeat value.
;; Finally, go back to BYTECHK to load the next RLE header byte.
;;

REPE	LDA	U+		;Increament U
	NEGA
	ADDA	#1
	LDB	U
REPE1	STB	,Y+
	DECA
	BNE	REPE1
	LDB	U+
	BRA	BYTECHK
	
;;
;; If the RLE header byte is 00-7F, then repeat the following byte(s). 
;; 00 means we are just copying one byte.  Once the unsigned counter
;; in B goes to $FF, we go back to BYTECHK.
;;
	
SPRCOPY	
	LDB	U+		;Grab first byte, increment U
.1LOOP	LDA	U+		;Grab second byte
	STA	,Y+
	DECB
	BPL	.1LOOP
	
	CMPU	#DATAEND	;Compare U with sprite data end address
	BLE	NEXTBYT		;are we done?
	BRA	*		;  yes, wait forever
NEXTBYT	BRA	BYTECHK		;  no, move on to next byte
